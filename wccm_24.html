<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
	<script src="http://localhost:1948/socket.io/socket.io.js"></script>
	<title>reveal.js</title>

	<link rel="stylesheet" href="dist/reset.css">
	<link rel="stylesheet" href="dist/reveal.css">
	<link rel="stylesheet" href="dist/theme/white-oden.css">

	<!-- Theme used for syntax highlighted code -->
	<link rel="stylesheet" href="plugin/highlight/monokai.css">
	<link rel="stylesheet" href="plugin/pointer/pointer.js">
	<style>
		.color-emph {
			color: #bf5700;
		}

		.fragment.c-fade-out {
			opacity: 1.0;
		}

		.fragment.c-fade-out.visible {
			opacity: 0.3;
		}

		.fragment.c-blur {
			filter: opacity(30%);
			transition: filter 0.25s ease-in-out;
			/* opacity: 0.3; */
		}

		.fragment.c-blur.current-fragment {
			filter: none;
			transition: filter 0.25s ease-in-out;
			/* opacity: 1.0; */
		}

		.fragment.c-blur2 {
			filter: opacity(50%);
			transition: filter 0.25s ease-in-out;
			/* opacity: 0.3; */
		}

		.fragment.c-blur2.current-fragment {
			filter: none;
			transition: filter 0.25s ease-in-out;
			/* opacity: 1.0; */
		}

		.faded {
			opacity: 0.5;
		}

		.footnote {
			font-size: 0.5em;
			/* color: grey; */
		}

		.caption {
			font-size: 0.5em;
		}

		.container {
			display: flex;
			justify-content: space-evenly;
		}

		.col {
			flex: 1;
		}

		#header-left {
			position: absolute;
			top: 0%;
			left: 0%;
		}

		#header-right {
			position: absolute;
			top: 0%;
			right: 0%;
		}

		#footer-left {
			position: absolute;
			bottom: 0%;
			left: 0%;
		}

		.reveal h1,
		.reveal h2,
		.reveal h3,
		.reveal h4,
		.reveal h5,
		.reveal h6 {
			text-transform: none;
		}

		.authors {
			font-size: 0.6em;
		}

		.myimg95 {
			width: 95%;
			margin: 5%;
		}

		.myimg80 {
			width: 80%;
			margin: 5%;
		}

		.leftalign {
			text-align: left;
		}

		.reveal sup {
			font-size: 0.65em;
		}

		/* .reveal .footnote sup {
			font-size: 0.65em;
		} */

		/* .reveal table td,
		.reveal table th {
			text-align: center;
			vertical-align: center;
		} */
	</style>
</head>

<body>
	<div class="reveal">
		<div class="slides">
			<section>
				<h2>Real-Time High-Fidelity Algorithms for <br>
					Extreme-Scale Bayesian Inverse Problems
					Involving Shift-Invariant Systems
				</h2>
				<p class="authors">Sreeram Venkat, Stefan Henneking, Milinda Fernando, and Omar Ghattas
				</p>

				<div class="container">
					<div class="col1">
						<img src="siam_pp_24/Oden-logo-cropped.svg" alt="Oden Institute" class="myimg95">
					</div>
					<div class="col2">
						<img src="siam_pp_24/Optimus-2-cropped.svg" alt="Optimus" class="myimg80">
					</div>
				</div>
			</section>
			<section>
				<section>
					<video data-src="siam_pp_24/tsunami-clip.mp4" id="tsunami-clip" class="r-stretch" data-autoplay
						loop></video>
					<p class="footnote"> <a href="https://www.youtube.com/watch?v=e5PJQW_6k6M">Source: Washington State
							Dept. of
							Natural Resources</a> </p>
				</section>
				<section>
					<img src="siam_pp_24/sensor-network.png" alt="Proposed Sensor Network" class="r-stretch">
					<p class="footnote"> <a href="http://cascadiaoffshore.org/story/White_Paper.html">Source: Cascadia
							Offshore
							White Paper</a> </p>
				</section>
				<section data-auto-animate>
					<h3>Cascadia Subduction Zone: Tsunami Early Warning</h3>
					<ul>
						<li>Predict tsunami wave propagation by <b class="color-emph">inversion of <u>near-field</u>
								pressure data</b>
							recorded during a megathrust rupture</li>
						<li>Quantify uncertainty in inverse solution via framework of <b class="color-emph">Bayesian
								inference</b></li>
						<li>Invert for the spatiotemporal seafloor motion (time-dependent boundary condition) using a
							(linearized) acoustic-gravity model in the (compressible) deep ocean</li>
					</ul>
				</section>
				<section data-auto-animate>
					<h2>Challenges</h2>
					<ul>
						<li>Forward problem involves 3D space + time</li>
						<li>Parameter is a 2D space + time field</li>
						<li>Hyperbolic forward PDEs don't easily lend themselves to surrogates</li>
						<li>Inversion computation must be done in <b class="color-emph">real time</b> (i.e. seconds)
						</li>
					</ul>
				</section>
			</section>
			<section>
				<section data-auto-animate>
					<h2>Forward Problem</h2>
					<ul>
						<li>Coupled <b class="color-emph"> Acoustic-Gravity </b> wave equations</li>
						<li><b class="color-emph">Velocity:</b> \(\boldsymbol{u}(\boldsymbol{x}, t)\), <b
								class="color-emph">Pressure:</b> \(p(\boldsymbol{x}, t)\),
							<b class="color-emph">Surface Height:</b> \(\eta(\boldsymbol{x}, t)\)
						</li>
					</ul>
					<img class="r-stretch" src="siam_pp_24/pde-domain-cropped.svg" alt="PDE Domain">
					<aside class="notes" aria-label="bcs">
						absorbing BCs on Gamma_a: 1st order, PML
					</aside>
				</section>
				<section data-auto-animate>
					<h2>Forward Problem</h2>
					<p>Coupled <b class="color-emph"> Acoustic-Gravity </b> wave equations: </p>
					<p class="leftalign">
						\[\begin{cases}
						\rho \frac{ \partial\boldsymbol{u}}{\partial t} + \nabla p = \boldsymbol{0},
						\frac{1}{K} \frac{ \partial p}{\partial t} + \nabla \cdot \boldsymbol{u} = 0, &
						\Omega \times (0,T)\nonumber\\
						p = \rho g \eta,
						\frac{ \partial\eta}{\partial t} = \boldsymbol{u} \cdot \hat{\boldsymbol{n}}, &
						\Gamma_s \times (0,T) \nonumber\\
						\boldsymbol{u} \cdot \hat{\boldsymbol{n}} = -\frac{\partial b}{\partial t}, & \Gamma_b
						\times (0,T) \text{\textcolor{BF5700}{&#8592; parameter}}\nonumber\\
						\boldsymbol{u} \cdot \hat{\boldsymbol{n}} = Z^{-1} p, & \Gamma_a \times (0,T)\nonumber
						\end{cases}
						\]
					</p>
					<p> bulk modulus \(K\), density \(\rho\), \(Z = \rho c\), \(c = \sqrt{K/\rho}\)
						<br> bathymetry \(b(\boldsymbol{x}, t)\); Homogeneous ICs; <b
							class="color-emph">observations</b> of \(p\) at sensors
					</p>
					<aside class="notes" aria-label="physparams">
						Z is acoustic wave impedance; c is sound speed in seawater
						<br>
						bathymetry related to seafloor motion is the parameter
					</aside>
				</section>
			</section>
			<section>
				<h2>Definitions</h2>
				<p class="leftalign"><em class="color-emph">Inverse Problem: </em>given observations, estimate model
					parameters (with quantified uncertainty)</p>
			</section>
			<section>
				<section>
					<h2>Bayesian Inverse Problem</h2>
					<ul>
						<li>
							<b class="color-emph">Goal:</b> determine posterior measure \(\mu_{\text{post}}\)
						</li>
						<li>
							\(m\): model parameters - spatiotemporal field \(=\frac{\partial b}{\partial t}
							(\boldsymbol{x},t)\) <br> \(d\): pressure obs. - pointwise space,
							continuous time: \(\left\{p(\boldsymbol{x}_i, t)\right\}_{i=1}^{N_d}\)
						</li>
						<li>
							<b class="color-emph">Bayes Rule:
							</b>
							<br>\(\frac{\text{d}\mu_{\text{post}}}{\text{d}\mu_{\text{prior}}} \propto
							\pi_{\text{like}}(d|m) =\exp\left(-\frac{1}{2}\|\mathcal{F}m -
							d\|_{\Gamma_{\text{noise}}^{-1}}^2\right)\) (in
							our
							case)
						</li>
						<br>
						<li>
							<b class="color-emph">Parameter-to-Observable (p2o) Map: </b>\(\mathcal{F}:
							m(\boldsymbol{x},t) \mapsto
							d(\boldsymbol{x}_i,t)\)
						</li>
					</ul>
				</section>
				<section data-auto-animate>
					<h2>Linear Inverse Problem, Gaussian Prior</h2>
					<p class="leftalign">
						<b class="color-emph">Prior: </b>\(m \sim \mathcal{N}(m_{\text{prior}},
						\Gamma_{\text{prior}})\)
						<br>
						<b class="color-emph">Mat&eacute;rn Covariance: </b>
						\(
						\Gamma_{\text{prior}} := \left(
						\alpha_1 I -
						\alpha_2 \Delta_{\text{2D}} -
						\alpha_3 \partial_t^2
						\right)^{-2}
						\)
					</p>
					<p class="leftalign">
						<b class="color-emph">Observations: </b>\(d = \mathcal{F}m + \nu\); \(\nu \sim
						\mathcal{N}(0,
						\Gamma_{\text{noise}}); \Gamma_{\text{noise}} = \gamma I\)
					</p>
					<p class="leftalign">
						<b class="color-emph">Posterior: </b>
						\[\begin{align*}
						\mu_{\text{post}} &= \mathcal{N}(m_{\text{map}},
						\Gamma_{\text{post}}) \\
						\Gamma_{\text{post}}&=\left(\mathcal{F}^* \Gamma_{\text{noise}}^{-1} \mathcal{F} +
						\Gamma_{\text{prior}}^{-1}\right)^{-1}\\
						m_{\text{map}}&=\Gamma_{\text{post}}\left(\mathcal{F}^* \Gamma_{\text{noise}}^{-1} d +
						\Gamma_{\text{prior}}^{-1} m_{\text{prior}}\right)
						\end{align*}\]
					</p>
					<p class="footnote">Script = infinite-dimensional; boldface = discrete in space and time</p>
				</section>
				<section data-auto-animate>
					<h2>Linear Inverse Problem, Gaussian Prior</h2>
					\[\begin{align*}
					\Gamma_{\text{post}}&=\left(\mathcal{F}^* \Gamma_{\text{noise}}^{-1} \mathcal{F} +
					\Gamma_{\text{prior}}^{-1}\right)^{-1}\\
					m_{\text{map}}&=\Gamma_{\text{post}}\left(\mathcal{F}^* \Gamma_{\text{noise}}^{-1} d +
					\Gamma_{\text{prior}}^{-1} m_{\text{prior}}\right)
					\end{align*}\]
					<p>
						Want to find \(m_{\text{map}}\) and \(\Gamma_{\text{post}}\) in <b
							class="color-emph">real-time</b>
					</p>

					<p class="footnote">
						Stuart, Andrew M. "Inverse problems: a Bayesian perspective." Acta numerica 19 (2010):
						451-559.
					</p>
					<aside class="notes" aria-label="postcov">
						Posterior covariance does not depend on data
					</aside>
				</section>
				<section data-auto-animate>
					<h2>Finding the MAP Point</h2>
					<ul>
						<li>
							\(\Gamma_{\text{post}}^{-1} =: \mathcal{H} \) is the <b class="color-emph">Hessian</b> (of
							negative log-posterior)
						</li>
						<li>
							Each Hessian action \(\mathcal{H}v\) requires <b class="color-emph">1 Forward PDE Solve</b>
							and
							<b class="color-emph">1 Adjoint PDE Solve</b> (traditionally)
						</li>
						<li>
							Solving \( \mathcal{H}m_{\text{map}} = \mathcal{F}^* \Gamma_{\text{noise}}^{-1} d +
							\Gamma_{\text{prior}}^{-1} m_{\text{prior}} \) with CG requires \(\text{rank}(\mathcal{H})\)
							Hessian actions<sup>1</sup>
						</li>
					</ul>
					<p class="footnote">
						<a
							href="https://www.cambridge.org/core/journals/acta-numerica/article/learning-physicsbased-models-from-data-perspectives-from-inverse-problems-and-model-reduction/C072A4B417F8C3873ED75C1D63BBB31D?utm_campaign=shareaholic&utm_medium=copy_link&utm_source=bookmark">
							<sup>1</sup>Ghattas, Omar, and Karen Willcox. "Learning physics-based models from data:
							perspectives
							from
							inverse problems and model reduction." Acta Numerica 30 (2021): 445-554.</a>
					</p>
				</section>
				<section data-auto-animate>
					<h2>Finding the MAP Point</h2>
					<ul>
						<li>
							For hyperbolic systems, \(\mathcal{H}\) can have high rank \(\Rightarrow\) many PDE solves
							\(\quad{}\)
						</li>
					</ul>
					<p>
						<b class="color-emph"> Cascadia Tsunami Problem: </b> <br>param. spatial DoFs: \(\sim
						10^6\),
						no. of sensors: \(\sim 10^2\), time steps: \(\sim 10^3\)
						<br> \(\Rightarrow\)
						\(\text{dim}(\mathbf{m}) \sim 10^{9}, \text{dim}(\mathbf{d}) \sim 10^5, N_t \sim 10^3\)
						<br> \(\Rightarrow\) \(\text{rank}(\mathbf{H}) \gtrsim 10^4\)
					</p>
					<ul>
						<li>
							\(\sim\) 1 hour / Hessian application<sup>1</sup> \(\Rightarrow\) over <b
								class="color-emph"> 1
								year
							</b>
							(on thousands of nodes) for CG to converge .
						</li>
						<li>
							Useless. We need to find the MAP point in <b class="color-emph">seconds</b>.
						</li>
					</ul>
					<p class="footnote"><sup>1</sup>PDE solve deals with 4D space-time state
						dimension \(\sim 10^{11}\) and has CFL
						constrained timestep.</p>
					<p class="footnote">Script = infinite-dimensional; boldface = discrete in space and time</p>
				</section>
			</section>
			<section>
				<h2>Definitions</h2>
				<p class="leftalign"><em class="color-emph">Inverse Problem: </em>given observations, estimate model
					parameters (with quantified uncertainty)</p>
				<p class="leftalign"><em class="color-emph">Autonomous Dynamical System: </em>evolution does not depend
					explicitly on independent variable (e.g. time)</p>
			</section>
			<section>
				<section data-auto-animate>
					<h2>Real-Time Inference</h2>
					<ul>
						<li>
							Split computations into <b class="color-emph">Offline</b> and <b
								class="color-emph">Online</b>
							phases
						</li>
						<li>
							Exploit (time) <em class="color-emph">shift-invariance</em> of autonomous dynamical systems
						</li>
					</ul>
				</section>
				<section data-auto-animate>
					<h2>Real-Time Inference</h2>
					<p class="leftalign fragment custom c-blur2 preload" data-fragment-index="0">
						<b class="color-emph">Phase 1</b> (Offline): Construct p2o map from adjoint PDE solves
					</p>
					<p class="leftalign fragment custom c-blur2">
						<b class="color-emph">Phase 2</b> (Offline): Compute compact representation of
						\(\Gamma_{\text{post}}\)
					</p>
					<p class="leftalign fragment custom c-blur2">
						<b class="color-emph">Phase 3</b> (Online): Compute MAP point in real-time
					</p>
				</section>
				<section data-auto-animate>
					<h2>Real-Time Inference</h2>
					<p class="leftalign">
						<b class="color-emph">Phase 1</b> (Offline): Construct p2o map from adjoint PDE solves
					</p>
					<p class="leftalign">
						<b class="color-emph">Phase 2</b> (Offline): Compute compact representation of
						\(\Gamma_{\text{post}}\)
					</p>
					<p class="leftalign">
						<b class="color-emph">Phase 3</b> (Online): Compute MAP point in real-time
					</p>
				</section>
				<section data-auto-animate>
					<h2>Real-Time Inference</h2>
					<p>
						<b class="color-emph">Phase 1</b> (Offline): Construct p2o map from adjoint PDE solves
					</p>
					<ul>
						<li>
							Recall: \( \mathbf{H} = \mathbf{F}^* \Gamma_{\text{noise}}^{-1} \mathbf{F} +
							\Gamma_{\text{prior}}^{-1}\)
						</li>
						<li>
							shift-invariance \(\Rightarrow\) \(\mathbf{F}\) is <em class="color-emph">block
								lower-triangular
								Toeplitz</em>
						</li>
						<li>Only <b class="color-emph">one</b> block row of \(\mathbf{F}^*\) needs to be
							computed/stored
						</li>
						<li>
							Adjoint PDE solved backwards in time with "source" at each observation point (\(\sim\)100
							sensors)
						</li>
					</ul>
					<aside class="notes" aria-label="causality">
						causality is the reason for lower-triangularity
					</aside>
				</section>


				<section data-auto-animate>
					<h2>Real-Time Inference</h2>
					<p class="leftalign">
						<b class="color-emph">Phase 2</b> (Offline): Compute compact representation of
						\(\Gamma_{\text{post}}\) (through Sherman-Morrison-Woodbury)
					</p>
					<p class="leftalign">
						<b class="color-emph">Phase 3</b> (Online): Compute MAP point in real-time
					</p>
					<ul>
						<li>
							Both rely on <b class="color-emph"> fast applications </b> of \(\mathbf{F}\) and
							\(\mathbf{F}^*\)
						</li>
						<li>
							Block Toeplitz structure \(\Rightarrow\) FFT-based matvecs (algorithm implemented on
							Multi-GPU
							setup)
						</li>
						<li>
							~<b class="color-emph">200,000x speedup</b> vs matrix-free MatVec via forward/adjoint PDE
							solves on Frontera CLX for ~100M parameters and 25K data points<sup>1</sup>
						</li>
					</ul>
					<p class="footnote"><sup>1</sup>8 NVIDIA A100 40GB GPU nodes (3 GPUs/node) vs 2048 CLX nodes (56
						cores/node).</p>
					<aside class="notes" aria-label="shift-invariance">
						Why not apply Toeplitz structure to forward solve? That works with the state dimension and
						CFL-limited time stepping which are much larger. The p2o matvec algorithm is agnostic to all of
						that.
					</aside>
				</section>
			</section>

			<section>
				<section data-auto-animate>
					<h2>Real-Time Inference</h2>
					<p class="leftalign faded" data-fragment-index="0">
						<b class="color-emph">Phase 1</b> (Offline): Construct p2o map from adjoint PDE solves
					</p>
					<p class="leftalign">
						<b class="color-emph">Phase 2</b> (Offline): Compute compact representation of
						\(\Gamma_{\text{post}}\)
					</p>
					<p class="leftalign faded">
						<b class="color-emph">Phase 3</b> (Online): Compute MAP point in real-time
					</p>
				</section>

				<section data-auto-animate>
					<h2>Dealing with
						\(\Gamma_{\text{post}}\)</h2>

					<p><b class="color-emph">Sherman-Morrison-Woodbury</b> applied to \(\Gamma_{\text{post}}\):
					</p>
					<p>
						\[
						\begin{alignat*}{2}
						\Gamma_{\text{post}}&=&&\left(\mathbf{F}^* \Gamma_{\text{noise}}^{-1} \mathbf{F} +
						\Gamma_{\text{prior}}^{-1}\right)^{-1}\\
						&=\Gamma_{\text{prior}}\Big(I -
						\mathbf{F}^*&&\underbrace{\textcolor{BF5700}{\Big(\Gamma_{\text{noise}}
						+
						\mathbf{F}\Gamma_{\text{prior}}\mathbf{F}^*\Big)}}_{}^{\textcolor{BF5700}{\mathbf{K}}}\vphantom{a}^{-1}\mathbf{F}\Gamma_{\text{prior}}\Big)

						\end{alignat*}
						\]
					</p>
					<p>\(\textcolor{BF5700}{\mathbf{K}}\) is a dense matrix of size \(\sim 10^5\times 10^5\)</p>
					<p>\(\Rightarrow\) Prefactorize or Compress</p>
				</section>

				<section data-auto-animate>
					<h2>Spectral Analysis</h2>
					<ul>
						<li>Build dense matrices \(\mathbf{F}\mathbf{F}^*\) and \(\mathbf{K}\)</li>
						<li>Prior solves done with <a href="https://developer.nvidia.com/cudss">cuDSS</a></li>
						<li>Spatial prior (no time correlation) means \(\Gamma_{\text{prior}}\mathbf{F}^*\) is block
							triangular Toeplitz</li>
					</ul>
					<aside class="notes" aria-label="prior Toeplitz">
						We only need to do prior solves of the \(N_d\) adjoint vectors instead of \(N_dN_t\). This
						also
						reduces communication from reordering.
					</aside>
				</section>

				<section data-auto-animate>
					<h4>Spectrum of \(\mathbf{F} \mathbf{F}^*\) </h4>
					<img src="wccm_24/FFstar-base.svg" alt="Spectrum of \(\mathbf{F} \mathbf{F}^*\)" class="r-stretch">
					<p class="caption">Representative case: \(N_m = 263\text{K}, N_d = 49, N_t = 500\)</p>
				</section>

				<section data-auto-animate>
					<h4>Spectrum of \(\mathbf{K} = \Gamma_{\text{noise}} +
						\mathbf{F}\Gamma_{\text{prior}}\mathbf{F}^*\) </h4>
					<img src="wccm_24/K-base.svg" alt="Spectrum of \(\mathbf{K}\)" class="r-stretch">
					<p class="caption">Representative case: \(N_m = 263\text{K}, N_d = 49, N_t = 500, \\
						\Gamma_{\text{noise}} = \gamma I, \gamma = 10^{-10}\), Bi-Laplacian
						Prior (spatial only)</p>
				</section>

				<section data-auto-animate>
					<h2>Spectral Analysis</h2>
					<ul>
						<li>Spectral decay of \(\mathbf{K}\) is not fast enough to use low-rank approximations</li>
						<li>\(\mathbf{K}\) can be pre-factorized and stored &mdash; less feasible as size increases
						</li>
						<li>Alternatives:
							<ul>
								<li>Create a preconditioner for \(\mathbf{K}\) to use with CG</li>
								<li>Compress \(\mathbf{K}\) with other methods (e.g. H-matrix approximations)</li>
							</ul>
						</li>
					</ul>
				</section>

				<section data-visibility="uncounted" data-auto-animate>
					<h2>Quantifying Uncertainty</h2>
					<ul>
						<li> <b class="color-emph">Pointwise Variance:</b> \(\text{diag}(\Gamma_{\text{post}})\) can be
							precomputed with stochastic estimators<sup>1</sup></li>
						<li>Alternative: subsample and interpolate on parameter grid</li>
						<li>Goal-oriented UQ approach: only consider uncertainty in forward prediction quantity of
							interest (QoI) of
							surface-gravity wave
							<ul>
								<li>\(\Gamma_{\text{pred}} :=
									\mathbf{F}_{\text{pred}}\Gamma_{\text{post}}\mathbf{F}_{\text{pred}}^* \in
									\mathbb{R}^{N_q\times N_q}\)</li>
								<li>\(\mathbf{F}_{\text{pred}}\) has a similar block-triangular Toeplitz structure to
									\(\mathbf{F}\)</li>
								<li>Choose a QoI with \(N_q \ll N_mN_t\) (e.g. wave height at specific locations)</li>
							</ul>
						</li>
					</ul>
					<aside class="notes" aria-label="post variance">
						Diagonal is independent of data.
					</aside>
					<p class="footnote"> <a href="https://epubs.siam.org/doi/10.1137/22M1476277"><sup>1</sup>Hallman,
							Eric, Ilse CF
							Ipsen,
							and Arvind K. Saibaba. "Monte Carlo methods for
							estimating the diagonal of a real symmetric matrix." SIAM Journal on Matrix Analysis and
							Applications 44.1 (2023): 240-269. </a></p>
				</section>

			</section>
			<section>
				<section data-auto-animate>
					<h2>Real-Time Inference</h2>
					<p class="leftalign faded" data-fragment-index="0">
						<b class="color-emph">Phase 1</b> (Offline): Construct p2o map from adjoint PDE solves
					</p>
					<p class="leftalign faded">
						<b class="color-emph">Phase 2</b> (Offline): Compute compact representation of
						\(\Gamma_{\text{post}}\)
					</p>
					<p class="leftalign">
						<b class="color-emph">Phase 3</b> (Online): Compute MAP point in real-time
					</p>
				</section>
				<section data-auto-animate>
					<h2>Real-Time Inference</h2>
					<p>\(
						\mathbf{m}_{\text{MAP}}=\Gamma_{\text{prior}}\left(\mathbf{I} -
						\mathbf{F}^*\textcolor{BF5700}{\mathbf{K}}^{-1}\mathbf{F}\Gamma_{\text{prior}}\right)\mathbf{F}^*\Gamma_{\text{noise}}^{-1}\mathbf{d}
						\)</p>
					<p>
						<b class="color-emph">Operations</b> <br>\(\left(N_m \sim 10^6, N_d \sim 10^2, N_t \sim
						10^3\right)\)
					</p>

					<ul>
						<li>\(2 \ \mathbf{F}^*\) matvecs &#8212; \(\mathcal{O}(N_dN_mN_t)\)</li>
						<li> \(1 \ \mathbf{F}\) matvec &#8212; \(\mathcal{O}(N_dN_mN_t)\)</li>
						<li> \(1 \ \textcolor{BF5700}{\mathbf{K}}\) solve &#8212;
							\(\mathcal{O}\left(N_d^2N_t^2\right)\)
							worst
							case
						</li>
						<li> \(1 \ \Gamma_{\text{prior}}\) solve<sup>1</sup> &#8212; \(\mathcal{O}(N_mN_t)\)</li>
					</ul>
					<p class="footnote">\(^1 \Gamma_{\text{prior}}\mathbf{F}^*\) is a block-triangular Toeplitz matrix
						for priors with only spatial correlation.</p>
				</section>
				<section data-auto-animate>
					<h2>Implementation</h2>
					<ul>
						<li><a href="https://petsc.org/release/">PETSc</a> interface to CUDA matvec code</li>
						<li>Multiple solver options for prior</li>
						<li><a href="https://developer.nvidia.com/cusolver">cuSOLVER</a>/<a
								href="https://docs.nvidia.com/cuda/cusolvermp/">cuSOLVERMp</a> backend for dense linear
							solves and eigenvalue decompositions</li>
					</ul>
				</section>
				<section data-auto-animate>
					<h2>Timing Results</h2>
					<p class="leftalign"><b class="color-emph">Test problem:</b> \(N_m = 263\text{K}, N_d = 49, N_t =
						500\)
						running
						on 8 nodes of <em class="color-emph">Lonestar6</em> at TACC (24 GPUs)</p>
					<p>\(
						\mathbf{m}_{\text{MAP}}=\Gamma_{\text{prior}}\left(\mathbf{I} -
						\mathbf{F}^*\textcolor{BF5700}{\mathbf{K}}^{-1}\mathbf{F}\Gamma_{\text{prior}}\right)\mathbf{F}^*\Gamma_{\text{noise}}^{-1}\mathbf{d}
						\)</p>
					<table>
						<tr>
							<th>Step</th>
							<th>Time (approx.)</th>
						</tr>
						<tr>
							<th>\(2 \ \mathbf{F}^*\) matvecs</th>
							<th>0.022s</th>
						</tr>
						<tr>
							<th>\(1 \ \mathbf{F}\) matvec</th>
							<th>0.011s</th>
						</tr>
						<tr>
							<th>\(1 \ \textcolor{BF5700}{\mathbf{K}}\) solve</th>
							<th>0.024s</th>
						</tr>
						<tr>
							<th>\(1 \ \Gamma_{\text{prior}}\) solve</th>
							<th>0.083s</th>
						</tr>
					</table>


				</section>
			</section>

			<section>
				<section data-auto-animate>
					<h2>Conclusions</h2>
					<ul>
						<li>
							Exploit autonomous structure to enable real-time inference at large scales
						</li>
						<li>
							Fast matvec algorithm speeds up p2o application by <b class="color-emph">~200,000x</b>
						</li>
						<li>
							Other applications: seismic source inversion, contaminant transport, CO2 monitoring
						</li>
					</ul>
				</section>
				<section data-auto-animate>
					<h2>Future Work</h2>
					<ul>
						<li>Linear Solver for \(\mathbf{K}\)</li>
						<li>Test on Cascadia meshes</li>
						<li>Try different sampling methods for posterior variance</li>
						<li>Consider goal-oriented UQ approach</li>
						<li>Data-driven priors</li>

					</ul>
				</section>
				<section>
					<h2>Thank You</h2>
					<div class="container">
						<div class="col1">
							<img src="siam_pp_24/Oden-logo-cropped.svg" alt="Oden Institute" class="myimg95">
						</div>
						<div class="col2">
							<img src="siam_pp_24/Optimus-2-cropped.svg" alt="Optimus" class="myimg80">
						</div>
					</div>
				</section>
			</section>
			<section>
				<section data-visibility="uncounted" data-auto-animate>
					<h2>Matvec Algorithm</h2>
					<ul>
						<li>Two indexing schemes:
							<ul>
								<li>SOTI (space-outer-time-inner)</li>
								<li>TOSI (time-outer-space-inner)</li>
								<li>PDE solves are usually TOSI</li>
							</ul>
						</li>
						<li><b class="color-emph">Preprocessing (start with \(\mathbf{F}\) in TOSI ordering):</b>
							<ol>
								<li>Reindex \(\mathbf{F}\) to SOTI \(\Rightarrow \mathbf{F}\) now has \(N_m\) blocks
									of
									\(N_t\)
									entries</li>
								<li>Take (padded) FFT of each block</li>
								<li>Swapaxes operation \(\Rightarrow\) TOSI</li>
							</ol>
						</li>

					</ul>

				</section>
				<section data-visibility="uncounted" data-auto-animate>
					<h2>Matvec Algorithm</h2>
					<ul>
						<li>Assume vector in SOTI (otherwise reindex)</li>
						<li>Vector: \(N_m\) blocks of \(N_t\) entries \(\big(N_d\) blocks for \(\mathbf{F}^*\big)\)
						</li>
						<li>Take (padded) <b class="color-emph">FFT</b> of each block (batched)</li>
						<li><b class="color-emph">Reindex</b> back to TOSI (transpose)</li>
						<li><b class="color-emph">SBGEMV</b> with cuBLAS \(\big(\)conjugate option for
							\(\mathbf{F}^*\big)\)
						</li>
						<li><b class="color-emph">Reindex</b> back to SOTI (transpose)</li>
						<li>Take <b class="color-emph">IFFT</b> of results (batched)</li>
						<li><b class="color-emph">Sum</b> over processor results (global reduction)</li>
					</ul>
				</section>
			</section>
		</div>
	</div>

	<!-- <div id="hidden" style="display:none;">
		<div id="header">
			<div id="header-left" style="display: block;">
				<img src="siam_pp_24/Oden-logo-cropped.svg" alt="Oden Institute" style="width: 75%; margin: 5%;">
			</div>
			<div id="header-right" style="display: block;">
			</div>
			<div id="footer-left">
				<img src="siam_pp_24/Optimus-2-cropped.svg" alt="Optimus" style="width: 60%; margin: 5%;">
			</div>
		</div>
	</div> -->

	<script src="dist/reveal.js"></script>
	<script src="plugin/notes/notes.js"></script>
	<script src="plugin/markdown/markdown.js"></script>
	<script src="plugin/highlight/highlight.js"></script>
	<script src="plugin/math/math.js"></script>
	<script src="plugin/search/search.js"></script>
	<script src="plugin/zoom/zoom.js"></script>
	<script src="plugin/pointer/pointer.js"></script>
	<!-- <script src="node_modules/reveal.js-notes-pointer/notes-pointer.js" async defer></script> -->
	<script src="https://code.jquery.com/jquery-3.7.1.min.js"
		integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>

	<script>
		// More info about initialization & config:
		// - https://revealjs.com/initialization/
		// - https://revealjs.com/config/
		Reveal.initialize({
			hash: true,

			// Learn about plugins: https://revealjs.com/plugins/
			plugins: [RevealMarkdown, RevealHighlight, RevealMath.KaTeX, RevealNotes, RevealSearch, RevealZoom],
			slideNumber: true,
			totalTime: 1500,

			multiplex: {
				// Example values. To generate your own, see the socket.io server instructions.
				secret: '17198636422737364430', // Obtained from the socket.io server. Gives this (the master) control of the presentation
				id: '9bab1850d60bbaa7', // Obtained from socket.io server
				url: 'https://reveal-multiplex.glitch.me/' // Location of socket.io server
			},

			// 'pointer': {"key": "q", "color": "#32cd32", "pointerSize": 18, "alwaysVisible": false},

			notes_pointer: {
				pointer: {
					size: 15,  // in pixels (scaled like the rest of reveal.js)
					color: 'rgba(255, 0, 0, 0.8)',  // something valid for css background-color
					key: 'A'
				},
				notes: {
					key: 'S'
				}
			},

			margin: 0,
			width: 1280,
			height: 720,

			// katex: {
			// 	version: 'latest',
			// 	delimiters: [
			// 		{left: '$$', right: '$$', display: true},
			// 		{left: '$', right: '$', display: false},
			// 		{left: '\\(', right: '\\)', display: false},
			// 		{left: '\\[', right: '\\]', display: true}
			// 	],
			// 	ignoredTags: ['script', 'noscript', 'style', 'textarea', 'pre']
			// },


			dependencies: [
				// ...
				{src: 'https://reveal-multiplex.glitch.me/socket.io/socket.io.js', async: true},
				{src: 'https://reveal-multiplex.glitch.me/master.js', async: true},

				{src: 'node_modules/reveal.js-notes-pointer/notes-pointer.js', async: true},
				// async is optional
			]


		});

		// automatically load the initial fragment on a slide if the fragment
		// has been defined with the 'preload' class
		Reveal.addEventListener('slidechanged', function (event) {
			if (event.currentSlide.querySelectorAll('.preload[data-fragment-index="0"]').length > 0) {
				Reveal.nextFragment();
			}
		});

		// if the initial fragment on a slide has been defined with a 'preload' class
		// then transition to the previous slide if the fragment is hidden
		Reveal.addEventListener('fragmenthidden', function (event) {
			if (event.fragment.hasAttribute('data-fragment-index') && event.fragment.classList.contains('preload')) {
				if (event.fragment.attributes['data-fragment-index'].value == "0") {
					Reveal.prev();
				}
			}
		});

		/* var header = $('#header').html();
		if (window.location.search.match(/print-pdf/gi)) {
			Reveal.addEventListener('ready', function (event) {
				$('.slide-background').append(header);
			});
		}
		else {
			$('div.reveal').append(header);
		}
		*/

	</script>
	<script>
		let vid = document.getElementById('tsunami-clip');
		vid.playbackRate = 7.5;
	</script>


</body>

</html>